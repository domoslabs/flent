include("netperf_definitions.inc")

DESCRIPTION="Data collected from DomosQED"
DEFAULTS={'PLOT': "CPU load"}

DATA_SETS = o([])
DOMOS_QED_HOSTS=get_test_parameter('domos_qed_hosts', default=[], split=True)
#Stats collection from the routers:
for router in DOMOS_QED_HOSTS:
    DATA_SETS.update([
        ("GF Stats " + router,
         {'test': 'CPU_STATS', 'interval': 0.2, 'length': LENGTH, 'sta': ("192.168.1.190","78:0c:b8:63:8b:8e"), 'host': router, 'interface': 'wlan0','units': '', 'runner': 'domqos'}),
    ])

#['QOSTime', 'Limit', 'CPU', 'min', 'avg', 'max', 'd_cycle_count', 'd_tx_cycle_count', 'd_rx_cycle_count', 'd_busy_count', 'ch_time_tx', 'ch_time_rx', 'ch_time_busy', 'ch_time', 'tx_packets', 'tx_bytes', 'tx_failed', 'rx_packets', 'rx_bytes', 'tx_bitrate', 'rx_bitrate', 'signal', 'signal_average', 'mac', 'radio', 'Time', 'IP', 'Snd#', 'NwRTD', 'PLEN']

PLOTS = o([
    ('CPU load',
     {'description': 'CPU load in %',
      'type': 'timeseries',
      'legend_title': 'CPU load',
      'series': [{'data': glob('GF Stats *'),
                  'raw_key': "CPU",
                  'label': 'CPU %'},]}
    ),
    ('GF Ping',
    {'description': 'Gaming first ping(ms)',
    'type': 'timeseries',
    'legend_title': 'GF Ping(ms)',
    'series': [{'data': glob('GF Stats *'),
                  'raw_key': "min",
                  'label': 'Ping (min)'},
                  {'data': glob('GF Stats *'),
                  'raw_key': "avg",
                  'label': 'Ping (avg)'},
                  {'data': glob('GF Stats *'),
                  'raw_key': "max",
                  'label': 'Ping (max)'},]}
    ),
    ('BW limit',
     {'description': 'BW limit (Mbit/s)',
      'type': 'timeseries',
      'legend_title': 'GF BW limit(Mbit/s)',
      'series': [{'data': glob('GF Stats *'),
                  'raw_key': "Limit",
                  'label': 'BW limit'},]}
    ),
    ('GF Data',
    {'description': "All GF data",
    'type': 'meta',
    'subplots': ('CPU load', 'GF Ping', 'BW limit')}),
    ('Radio stats',
     {'description': '',
      'type': 'timeseries',
      'legend_title': 'Channel use in ms',
      'series': [{'data': glob('GF Stats *'),
                  'raw_key': "ch_time",
                  'label': 'ch_time',
                  'ignore_zeros': 1,},
                  {'data': glob('GF Stats *'),
                  'raw_key': "ch_time_busy",
                  'label': 'ch_time_busy',
                  'ignore_zeros': 1,},
                  {'data': glob('GF Stats *'),
                  'raw_key': "ch_time_tx",
                  'label': 'ch_time_tx',
                  'ignore_zeros': 1,},
                  {'data': glob('GF Stats *'),
                  'raw_key': "ch_time_rx",
                  'label': 'ch_time_rx',
                  'ignore_zeros': 1,},]}
    ),
    ('Packet volume',
     {'description': 'Chanim',
      'type': 'timeseries',
      'legend_title': 'GF BW limit(Mbit/s)',
      'series': [{'data': glob('GF Stats *'),
                  'raw_key': "obss",
                  'label': 'obss'},
                  {'data': glob('GF Stats *'),
                  'raw_key': "inbss",
                  'label': 'inbss'},
                  {'data': glob('GF Stats *'),
                  'raw_key': "txop",
                  'label': 'txop'},
                  {'data': glob('GF Stats *'),
                  'raw_key': "tx",
                  'label': 'tx'},]}
    ),    

    ]
)